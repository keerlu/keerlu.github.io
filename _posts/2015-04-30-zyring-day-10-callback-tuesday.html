---
layout: post
title: Zyring Day 10 - Callback Tuesday
date: 2015-04-30 17:45:59.000000000 +01:00
categories: []
tags:
- Angular
- JavaScript
- Zyring
status: publish
type: post
published: true
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '67112767'
  geo_public: '0'
  _publicize_pending: '1'
author:
  login: wotidun
  email: wotidunread@gmail.com
  display_name: wotidun
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p><em>[Note: These are more in-depth (read: tedious) write-ups of my experience with each section of the Zyring project, leading on from my <a href="https://wotidun.wordpress.com/2015/04/14/wot-i-dun-zyring-project/">intro post</a> on Zyring. This is mostly for my own benefit but could conceivably be of use to someone doing the project.]</em></p>
<h2>Divide apartments in a city into pages, part 1</h2>
<p>This tutorial has a nice innocuous title but actually stumped me for ages. I spent all day on this but learnt some very useful stuff about JavaScript in the process (see later).</p>
<p>The idea of the tutorial is exactly what it says - divide up the list of apartments so that instead of vomiting a hundred or so apartments onto one page, it splits them into more user-friendly batches of 9. This also allows faster loading speeds and a less cluttered map. Seems reasonable.</p>
<p>The tutorial goes into very thorough detail on the process of how to split an array of data into sub-arrays. I think I could have worked this out OK on my own but I'm not complaining. The problem I had was how to adapt this method for getting my array from the backend server instead of one I've got saved in my current file. First I needed to understand a bit more about  <code>$resource</code> and its <code>query</code> method, as I'd copied it in kind of mindlessly. I read some of the information on the previously linked (and very useful) tutorial on <a href="http://www.sitepoint.com/creating-crud-app-minutes-angulars-resource/">creating a CRUD app</a>, and got my head around the syntax a bit better.</p>
<p>However, I was still confused: I tried printing my <code>query({cityName: $routeParams.cityName})</code> to <code>console.log</code> and it was coming up empty. However, I'd used this in the previous tutorial and it definitely had some data stored in it. This looks like some kind of asynchronous thingy (to use the technical term).</p>
<p>:( Time for some research.</p>
<h2>Callback Tuesdays</h2>
<p>At this point I should admit that I've been treating JavaScript as some version of Python, except it has the wrong syntax and runs in the browser. This approach was starting to fall apart a little...</p>
<p>I looked at Zyring's own documentation on the <code>$resource</code> service and read the sentence</p>
<blockquote><p>
  "If you like to be notified exactly when the results become available, you can pass in a function callback to the get and query methods"
</p></blockquote>
<p>I realised I didn't really know what a callback is, and that I probably should if I was going to do anything time-dependent. Luckily when I googled it there were several decent introductions. I ended up playing with some examples based on this <a href="http://www.impressivewebs.com/callback-functions-javascript/">nice tutorial</a> and <a href="http://jsbin.com/ozuloq/1/edit?html,js,output">runnable example</a>. Below are my notes on this for future reference.</p>
<p>Their example is something like:</p>

{% highlight js %}

function mySandwich(param1, param2, callback) {
console.log('Started eating my sandwich.nIt has ' + param1 + ' and ' + param2 + ' in it.');
callback();
}

mySandwich('ham', 'cheese', function() {
console.log('Finished eating my sandwich.');
});

{% endhighlight %}

<p>This produces:</p>
<blockquote><p>
  "Started eating my sandwich.<br />
  It has ham and cheese in it."<br />
  "Finished eating my sandwich."
</p></blockquote>
<p>We have freedom to change the function:</p>

{% highlight js %}

mySandwich('tuna', 'banana', function() {
console.log('Bleeeurgh...');
});

{% endhighlight %}

<p>This gives</p>
<blockquote><p>
  "Started eating my sandwich.<br />
  It has tuna and banana in it."<br />
  "Bleeeurgh..."
</p></blockquote>
<p>Or here's an example with a callback function with a parameter:</p>

{% highlight js %}

function anotherSandwich(param1, param2, callback) {
console.log('Time for another sandwich.nnIt has ' + param1 + ' and ' + param2 + ' in it.');
callback(param2);
}

anotherSandwich('ham', 'mustard', function(param) {
console.log('Shame I hate ' + param + '.');
});

{% endhighlight %}

<p>which gives</p>
<blockquote><p>
  "Time for another sandwich.<br />
  It has ham and mustard in it."<br />
  "Shame I hate mustard."
</p></blockquote>
<h2>Divide apartments in a city into pages, part 1</h2>
<p>So this gave me some basic idea about callbacks, including the idea that I might want to implement my pagination algorithm in a function callback to <code>$resource.query</code>, so that the array has been fetched from the server before I start doing anything with it. I don't know if this is the 'proper' way to do it, but it worked anyway.</p>
<p>Finally, writing the pagination algorithm based on the example went pretty smoothly, and I had my big array of apartment data split into a bunch of smaller arrays. I wasn't whether I was supposed to do anything else with it right now, like connect it up to the html file somehow, but I thought I'd keep going and see what the later tutorials said... I can always go back if necessary.</p>
